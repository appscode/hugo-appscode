<!doctype html><html lang=en><head><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-62096468-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content="#00A651"><title>ServiceBroker Home</title><meta name=description content="Accelerating the transition to Containers by building a Kubernetes-native Data Platform"><meta name=author content="AppsCode Inc."><meta name=keywords content="application monitoring,attic,build docker image,cloud app,cloud deployment,cloud hosting,container applications,continuous deployment,deployment automation,git hosting,kubernetes autoscaling,nagios,network monitor,repository hosting,source code repository"><link rel=apple-touch-icon sizes=57x57 href=/assets/images/products/appscode/icons/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/assets/images/products/appscode/icons/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/assets/images/products/appscode/icons/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/assets/images/products/appscode/icons/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/assets/images/products/appscode/icons/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/assets/images/products/appscode/icons/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/assets/images/products/appscode/icons/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/assets/images/products/appscode/icons/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/assets/images/products/appscode/icons/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/assets/images/products/appscode/icons/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/assets/images/products/appscode/icons/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/assets/images/products/appscode/icons/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/assets/images/products/appscode/icons/favicon-16x16.png><link rel=manifest href=/assets/images/products/appscode/icons/manifest.json><meta name=msapplication-TileColor content="#ffffff"><meta name=msapplication-TileImage content="/assets/images/products/appscode/icons/ms-icon-144x144.png"><meta name=twitter:card content="summary"><meta name=twitter:site content="@AppsCodeHQ"><meta name=twitter:title content="AppsCode Inc."><meta name=twitter:creator content="@AppsCodeHQ"><meta name=twitter:description content="Accelerating the transition to Containers by building a Kubernetes-native Data Platform"><meta name=twitter:image:src content="/assets/images/products/appscode/appscode-1280x640.png"><meta property="og:url" content="https://appscode.com"><meta property="og:title" content="AppsCode Inc."><meta property="og:description" content="Accelerating the transition to Containers by building a Kubernetes-native Data Platform"><meta property="og:site_name" content="AppsCode Inc."><meta property="og:image" content="/assets/images/products/appscode/appscode-1280x640.png"><meta property="og:type" content="article"><link rel=stylesheet href=/assets/css/font-awesome.min.css><link href=https://unpkg.com/aos@2.3.1/dist/aos.css rel=stylesheet><link rel=stylesheet href=/assets/css/bulma-carousel.min.css><link rel=stylesheet href=/assets/css/bulma-tooltip.min.css><link rel=stylesheet href=/assets/css/bulma.min.css><link rel=stylesheet href=/assets/sass/main.min.0e8b818ba1fa5baf0e6a01eebc7680b7e5835004ff37ea37fda0c762e8564d80.css></head><body class=service-broker><header><div class="header-top fixed-menu-z-index"><div class="container section"><nav class=navbar><div class=navbar-brand><a class=navbar-item href=https://appscode.com><img src=/assets/images/products/appscode/appscode.png alt=AppsCode></a>
<a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=acNav1><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=acNav1 class="navbar-menu main-menu"><div class=navbar-end><div class=navbar-start><div class="navbar-item has-dropdown ac-is-hoverable"><a class=navbar-link>Products</a><div class=ac-megamenu><div class=columns><div class="column is-8"><div class=columns><div class="column is-6 br-1"><a href=https://kubedb.com class="single-product-item is-kubedb"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/kubedb/kubedb-icon.png alt=KubeDB></div><h5>KubeDB</h5></div><div class=menu-body><p>Run production-grade databases easily on Kubernetes</p></div></a><a href=https://stash.run class="single-product-item is-stash"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/stash/stash-icon.png alt=Stash></div><h5>Stash</h5></div><div class=menu-body><p>Backup your Kubernetes Stateful Applications</p></div></a><a href=https://kubevault.com class="single-product-item is-kubevault"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/kubevault/kubevault-icon.png alt=KubeVault></div><h5>KubeVault</h5></div><div class=menu-body><p>Tools for running HashiCorp Vault on Kubernetes</p></div></a><a href=https://appscode.com/products/guard/ class="single-product-item is-guard"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/guard/guard-icon.png alt=Guard></div><h5>Guard</h5></div><div class=menu-body><p>Kubernetes Authentication WebHook Server</p></div></a></div><div class="column is-6 br-1"><a href=https://appscode.com/products/voyager/ class="single-product-item is-voyager"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/voyager/voyager-icon.png alt=Voyager></div><h5>Voyager</h5></div><div class=menu-body><p>Secure HAProxy Ingress Controller for
Kubernetes</p></div></a><a href=https://appscode.com/products/swift/ class="single-product-item is-swift"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/swift/swift-icon.png alt=Swift></div><h5>Swift</h5></div><div class=menu-body><p>Ajax friendly Helm Tiller Proxy</p></div></a><a href=https://appscode.com/products/searchlight/ class="single-product-item is-searchlight"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/searchlight/searchlight-icon.png alt=Searchlight></div><h5>Searchlight</h5></div><div class=menu-body><p>Alerts for Kubernetes</p></div></a><a href=https://appscode.com/products/kubed/ class="single-product-item is-kubed"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/kubed/kubed-icon.png alt=Kubed></div><h5>Kubed</h5></div><div class=menu-body><p>Kubernetes cluster manager daemon</p></div></a></div></div></div><div class="column is-4"><div class=columns><div class="column is-12"><a href=https://byte.builders class="single-product-item byte-builder kd-orange"><div class=menu-header><p class=intro>Introducing....</p><h5>ByteBuilders</h5></div><div class=menu-body><p>Cloud reimagined for the age of Kubernetes</p></div><p class=learn-more-btn>Learn more
<span class=icon><i class="fa fa-long-arrow-right" aria-hidden=true></i></span></p></a><a href=https://pharmer.io class="single-product-item is-pharmer"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/pharmer/pharmer-icon.png alt=Pharmer></div><h5>Pharmer</h5></div><div class=menu-body><p>Kubernetes Cluster Manager using Kubeadm & Cluster API</p></div></a><a href=https://kubeform.com class="single-product-item is-kubeform"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/kubeform/kubeform-icon.png alt=Kubeform></div><h5>Kubeform</h5></div><div class=menu-body><p>Provision cloud resources using Kubernetes CRDs & Terraform</p></div></a></div></div></div></div><div class="columns has-text-centered"><div class=column><div class=menu-bottom><p>Explore apps and integrations for AppsCode products:
<a href=https://marketplace.byte.builders>Visit the Marketplace
<i class="fa fa-long-arrow-right" aria-hidden=true></i></a></p></div></div></div></div></div><div class="navbar-item has-dropdown ac-is-hoverable"><a class=navbar-link>Services</a><div class=ac-dropdown><a class=navbar-item href=https://appscode.com/consulting/>Consulting</a>
<a class=navbar-item href=https://appscode.com/training/>Training</a>
<a class=navbar-item href=https://appscode.com/support/>Support</a></div></div><a class=navbar-item href=https://blog.byte.builders>Blog</a>
<a class=navbar-item href=https://appscode.com/contact/>Contact Us</a></div><div class=navbar-item><div class="buttons main-menu-button-top"><a class="button is-small for-chat" href=https://slack.appscode.com><span><img src=/assets/images/icon/slack.png alt></span>Slack</a>
<a class="button is-small for-support" href=https://appscode.freshdesk.com><span><img src=/assets/images/icon/chat.png alt></span>Support Portal</a></div></div></div></div></nav></div></div><div class="header-bottom-area header-area kubedb-primary-bg customize-kubedb fixed-menu"><div class="container section"><nav class=navbar><div class=navbar-brand><a class=navbar-item href=https://appscode.com/products/service-broker/><img src=/assets/images/products/service-broker/service-broker-white.png alt=ServiceBroker></a>
<a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=acNav><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=acNav class="navbar-menu main-menu"><div class=navbar-end><div class=navbar-start><a href=/products/service-broker/0.3.1/welcome/ class=navbar-item>Documentation</a><div class="navbar-item has-dropdown ac-is-hoverable"><a class=navbar-link>Community</a><div class=ac-dropdown><a href=https://github.com/appscode/service-broker class=navbar-item>GitHub</a>
<a href=https://twitter.com/AppsCodeHQ class=navbar-item>Twitter</a>
<a href=https://slack.appscode.com class=navbar-item>Slack</a></div></div></div><div class=navbar-item><div class="buttons main-menu-button"><img style=height:24px alt="GitHub Stars" src="https://img.shields.io/github/stars/appscode/service-broker?style=flat&labelColor=1B3D4B&color=06A64F&logoColor=white&logo=github">
&nbsp;&nbsp;&nbsp;
<img style=height:24px alt="Docker Pulls" src="https://img.shields.io/docker/pulls/appscode/service-broker?style=flat&labelColor=1B3D4B&color=06A64F&logoColor=white&logo=docker"></div></div></div></div></nav></div></div><div class=documentation-menu><div class="container section"><div class=is-centered><div class="is-half has-text-centered-desktop"><div class=responsive-menu><a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=acNav3><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><nav class=documentation-navbar><div id=acNav3 class="navbar-menu nav-menu main-menu"><div class=navbar-centered><div class=navbar-start><a href=/products/service-broker/0.1.0/ class=navbar-item>Welcome</a>
<a href=/products/service-broker/0.1.0/concepts/ class=navbar-item>Concepts</a>
<a href=/products/service-broker/0.1.0/setup/ class=navbar-item>Setup</a>
<a href=/products/service-broker/0.1.0/guides/ class="is-active navbar-item">Guides</a>
<a href=/products/service-broker/0.1.0/reference/ class=navbar-item>Reference</a></div></div></div></nav></div></div></div></div></header><div class=documentation-area><div class="container section"><div class=columns><div class="column is-3"><div class=kd-left-sidebar><div class=trial-button><a href=/products/service-broker/0.3.1/setup/ class="button is-fullwidth">Try Now for FREE!</a></div><div class=kd-version><div class=dropdown><div class=dropdown-trigger><button class="button is-fullwidth" aria-haspopup=true aria-controls=dropdown-menu3>
<span><strong class=icon><i class="fa fa-cog" aria-hidden=true></i></strong>0.1.0</span>
<span class="icon is-small"><i class="fa fa-angle-down" aria-hidden=true></i></span></button></div><div class=dropdown-menu id=dropdown-menu3 role=menu><div class=dropdown-content><a href=https://github.com/appscode/service-broker/tree/master/docs target=_blank class=dropdown-item>master</a>
<a href=/products/service-broker/0.3.1/ class=dropdown-item>0.3.1<div class=tag>Latest</div></a><a href=/products/service-broker/0.3.0/ class=dropdown-item>0.3.0</a>
<a href=/products/service-broker/0.2.0/ class=dropdown-item>0.2.0</a>
<a href=/products/service-broker/0.1.0/ class=dropdown-item>0.1.0</a></div></div></div></div><div class=kd-sidebar-menu><div class=item><input type=checkbox id=37e311e51a278f833a3c9ba25a649b0b-1>
<label for=37e311e51a278f833a3c9ba25a649b0b-1><a href=/products/service-broker/0.1.0/guides/>Guides</a></label></div><div class=item><input type=checkbox id=37e311e51a278f833a3c9ba25a649b0b-2 checked>
<label for=37e311e51a278f833a3c9ba25a649b0b-2><a>KubeDB</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/products/service-broker/0.1.0/guides/kubedb/elasticsearch/>Elasticsearch</a></li><li><a href=/products/service-broker/0.1.0/guides/kubedb/memcached/>Memcached</a></li><li><a href=/products/service-broker/0.1.0/guides/kubedb/mongodb/>Mongodb</a></li><li><a href=/products/service-broker/0.1.0/guides/kubedb/mysql/>MySQL</a></li><li class=is-active><a href=/products/service-broker/0.1.0/guides/kubedb/postgres/>PostgreSQL</a></li><li><a href=/products/service-broker/0.1.0/guides/kubedb/redis/>Redis</a></li></ul></div></div><div class=item><input type=checkbox id=37e311e51a278f833a3c9ba25a649b0b-3>
<label for=37e311e51a278f833a3c9ba25a649b0b-3><a>Monitoring</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/products/service-broker/0.1.0/guides/monitoring/overview/>Overview</a></li><li><a href=/products/service-broker/0.1.0/guides/monitoring/builtin/>Builtin Prometheus</a></li><li><a href=/products/service-broker/0.1.0/guides/monitoring/coreos/>Prometheus Operator</a></li></ul></div></div><div class=item><input type=checkbox id=37e311e51a278f833a3c9ba25a649b0b-4>
<label for=37e311e51a278f833a3c9ba25a649b0b-4><a href=/products/service-broker/0.1.0/guides/kubeapps/>Using Kubeapps</a></label></div></div></div></div><div class="column is-7"><div class=full-info><blockquote><p>New to AppsCode Service Broker? Please start <a href=/products/service-broker/0.1.0/concepts/README>here</a>.</p></blockquote><h1 id=postgresql-walk-through>PostgreSQL Walk-through</h1><p>This tutorial will show you how to use AppsCode Service Broker to provision and deprovision an PostgreSQL cluster and bind to the PostgreSQL service.</p><p>Before we start, you need to have a Kubernetes cluster, and the kubectl command-line tool must be configured to communicate with your cluster. If you do not already have a cluster, you can create one by using <a href=https://github.com/kubernetes/minikube>Minikube</a>. Then install Service Catalog onto your cluster. If you haven&rsquo;t, please see the <a href=https://github.com/kubernetes-incubator/service-catalog/blob/v0.1.38/docs/install.md>installation instructions</a> for Service Catalog. Optionally you may install the Service Catalog CLI, <code>svcat</code>. Examples for both <code>svcat</code> and <code>kubectl</code> are provided so that you may follow this walk-through using <code>svcat</code> or using only <code>kubectl</code>.</p><p>If you&rsquo;ve AppsCode Service Broker installed, then we are ready for the next step. If not, follow the <a href=/products/service-broker/0.1.0/setup/install>instructions</a> to install KubeDB and AppsCode Service Broker.</p><p>To keep things isolated, we are going to use a separate namespace called <code>demo</code> throughout this tutorial.</p><pre><code class=language-console data-lang=console>$ kubectl create ns demo
namespace/demo created
</code></pre><blockquote><p>All commands in this document assume that you&rsquo;re operating out of the root of this repository.</p></blockquote><h2 id=check-clusterserviceclass-and-clusterserviceplan-for-postgres>Check ClusterServiceClass and ClusterServicePlan for Postgres</h2><p>First, list the available <code>ClusterServiceClass</code> resources:</p><pre><code class=language-console data-lang=console>$ kubectl get clusterserviceclasses
NAME                                   EXTERNAL-NAME   BROKER                    AGE
2010d83f-d908-4d9f-879c-ce8f5f527f2a   postgresql      appscode-service-broker   2h
315fc21c-829e-4aa1-8c16-f7921c33550d   elasticsearch   appscode-service-broker   2h
938a70c5-f2bc-4658-82dd-566bed7797e9   mysql           appscode-service-broker   2h
ccfd1c81-e59f-4875-a39f-75ba55320ce0   redis           appscode-service-broker   2h
d690058d-666c-45d8-ba98-fcb9fb47742e   mongodb         appscode-service-broker   2h
d88856cb-fe3f-4473-ba8b-641480da810f   memcached       appscode-service-broker   2h

$ svcat get classes
      NAME        NAMESPACE           DESCRIPTION
+---------------+-----------+------------------------------+
  postgresql                  KubeDB managed PostgreSQL
  elasticsearch               KubeDB managed ElasticSearch
  mysql                       KubeDB managed MySQL
  redis                       KubeDB managed Redis
  mongodb                     KubeDB managed MongoDB
  memcached                   KubeDB managed Memcached
</code></pre><p>Now, describe the <code>postgresql</code> class from the <code>Service Broker</code>.</p><pre><code class=language-console data-lang=console>$ svcat describe class postgresql
  Name:              postgresql
  Scope:             cluster
  Description:       KubeDB managed PostgreSQL
  Kubernetes Name:   2010d83f-d908-4d9f-879c-ce8f5f527f2a
  Status:            Active
  Tags:
  Broker:            appscode-service-broker

Plans:
         NAME                   DESCRIPTION
+--------------------+--------------------------------+
  postgresql           PostgreSQL database with
                       custom specification
  demo-ha-postgresql   Demo HA PostgreSQL database
  demo-postgresql      Demo Standalone PostgreSQL
                       database
</code></pre><p>To view the details of any plan in this class use command <code>$ svcat describe plan &lt;class_name>/&lt;plan_name></code>. For example:</p><pre><code class=language-console data-lang=console>$ svcat describe plan postgresql/postgresql --scope cluster
  Name:              postgresql
  Description:       PostgreSQL database with custom specification
  Kubernetes Name:   13373a9b-d5f5-4d9a-88df-d696bbc19071
  Status:            Active
  Free:              true
  Class:             postgresql

Instances:
No instances defined
</code></pre><blockquote><p>Here we,ve used <code>--scope</code> flag to specify that our <code>ClusterServiceBroker</code>, <code>ClusterServiceClass</code> and <code>ClusterServiceBroker</code> resources are cluster scoped (not namespaced scope)</p></blockquote><h2 id=provisioning-creating-a-new-serviceinstance>Provisioning: Creating a New ServiceInstance</h2><p>AppsCode Service Broker currently supports three plans for <code>postgresql</code> class as we can see above. Using <code>demo-postgresql</code> plan we can provision a demo PostgreSQL database. Using <code>demo-ha-postgresql</code> plan we can provision a demo HA PostgreSQL database. And using <code>postgresql</code> plan we can provision a custom PostgreSQL database with the full functionality of a <a href=https://kubedb.com/docs/0.10.0/concepts/databases/postgres>Postgres CRD</a>.</p><p>AppsCode Service Broker accepts only metadata and <a href=https://kubedb.com/docs/0.10.0/concepts/databases/postgres/#postgres-spec>Postgres Spec</a> as parameters for the plans of <code>postgresql</code> class. The metadata and spec should be provided with key <code>"metadata"</code> and <code>"spec"</code> respectively. The metadata is optional for all of the plans available. But the spec is required for the custom plan and it must be valid.</p><p>Since a <code>ClusterServiceClass</code> named <code>postgresql</code> exists in the cluster with a <code>ClusterServicePlan</code> named <code>postgresql</code>, we can create a <code>ServiceInstance</code> pointing to them with custom specification as parameters.</p><blockquote><p>Unlike <code>ClusterServiceBroker</code>, <code>ClusterServiceClass</code> and <code>ClusterServicePlan</code> resources, <code>ServiceInstance</code> resources must be namespaced. The latest version of .service catalog supports <code>ServiceBroker</code>, <code>ServiceClass</code> and <code>ServicePlan</code> resources that are namespace scoped and alternative to <code>ClusterServiceBroker</code>, <code>ClusterServiceClass</code> and <code>ClusterServicePlan</code> resources.</p></blockquote><p>Create the <code>ServiceInstance</code>:</p><pre><code class=language-console data-lang=console>$ kubectl create -f docs/examples/postgresql-instance.yaml
serviceinstance.servicecatalog.k8s.io/postgresqldb created
</code></pre><p>After it is created, the service catalog controller will communicate with the service broker server to initiate provisioning. Now, see the details:</p><pre><code class=language-console data-lang=console>$ svcat describe instance postgresqldb --namespace demo
  Name:        postgresqldb
  Namespace:   demo
  Status:      Ready - The instance was provisioned successfully @ 2018-12-26 10:17:55 +0000 UTC
  Class:       postgresql
  Plan:        postgresql

Parameters:
  metadata:
    labels:
      app: my-postgres
  spec:
    storage:
      accessModes:
      - ReadWriteOnce
      resources:
        requests:
          storage: 1Gi
      storageClassName: standard
    terminationPolicy: WipeOut
    version: 10.2-v1

Bindings:
No bindings defined
</code></pre><p>The yaml configuration of this <code>ServiceInstance</code>:</p><pre><code class=language-console data-lang=console>kubectl get serviceinstance postgresqldb --namespace demo -o yaml
</code></pre><p>Output:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>apiVersion</span>: servicecatalog.k8s.io/v1beta1
<span style=color:#66d9ef>kind</span>: ServiceInstance
<span style=color:#66d9ef>metadata</span>:
  <span style=color:#66d9ef>creationTimestamp</span>: <span style=color:#e6db74>&#34;2018-12-26T10:17:54Z&#34;</span>
  <span style=color:#66d9ef>finalizers</span>:
  - kubernetes-incubator/service-catalog
  <span style=color:#66d9ef>generation</span>: <span style=color:#ae81ff>1</span>
  <span style=color:#66d9ef>labels</span>:
    <span style=color:#66d9ef>app</span>: appscode-service-broker
  <span style=color:#66d9ef>name</span>: postgresqldb
  <span style=color:#66d9ef>namespace</span>: demo
  <span style=color:#66d9ef>resourceVersion</span>: <span style=color:#e6db74>&#34;202&#34;</span>
  <span style=color:#66d9ef>selfLink</span>: /apis/servicecatalog.k8s.io/v1beta1/namespaces/demo/serviceinstances/postgresqldb
  <span style=color:#66d9ef>uid</span>: 82223da0-08f7<span style=color:#ae81ff>-11e9</span>-9fa4-0242ac110006
<span style=color:#66d9ef>spec</span>:
  <span style=color:#66d9ef>clusterServiceClassExternalName</span>: postgresql
  <span style=color:#66d9ef>clusterServiceClassRef</span>:
    <span style=color:#66d9ef>name</span>: 2010d83f-d908-4d9f-879c-ce8f5f527f2a
  <span style=color:#66d9ef>clusterServicePlanExternalName</span>: postgresql
  <span style=color:#66d9ef>clusterServicePlanRef</span>:
    <span style=color:#66d9ef>name</span>: 13373a9b-d5f5-4d9a-88df-d696bbc19071
  <span style=color:#66d9ef>externalID</span>: 82223d44-08f7<span style=color:#ae81ff>-11e9</span>-9fa4-0242ac110006
  <span style=color:#66d9ef>parameters</span>:
    <span style=color:#66d9ef>metadata</span>:
      <span style=color:#66d9ef>labels</span>:
        <span style=color:#66d9ef>app</span>: my-postgres
    <span style=color:#66d9ef>spec</span>:
      <span style=color:#66d9ef>storage</span>:
        <span style=color:#66d9ef>accessModes</span>:
        - ReadWriteOnce
        <span style=color:#66d9ef>resources</span>:
          <span style=color:#66d9ef>requests</span>:
            <span style=color:#66d9ef>storage</span>: 1Gi
        <span style=color:#66d9ef>storageClassName</span>: standard
      <span style=color:#66d9ef>terminationPolicy</span>: WipeOut
      <span style=color:#66d9ef>version</span>: <span style=color:#ae81ff>10.2</span>-v1
  <span style=color:#66d9ef>updateRequests</span>: <span style=color:#ae81ff>0</span>
  <span style=color:#66d9ef>userInfo</span>:
    <span style=color:#66d9ef>groups</span>:
    - system:masters
    - system:authenticated
    <span style=color:#66d9ef>uid</span>: <span style=color:#e6db74>&#34;&#34;</span>
    <span style=color:#66d9ef>username</span>: minikube-user
<span style=color:#66d9ef>status</span>:
  <span style=color:#66d9ef>asyncOpInProgress</span>: <span style=color:#66d9ef>false</span>
  <span style=color:#66d9ef>conditions</span>:
  - <span style=color:#66d9ef>lastTransitionTime</span>: <span style=color:#e6db74>&#34;2018-12-26T10:17:55Z&#34;</span>
    <span style=color:#66d9ef>message</span>: The instance was provisioned successfully
    <span style=color:#66d9ef>reason</span>: ProvisionedSuccessfully
    <span style=color:#66d9ef>status</span>: <span style=color:#e6db74>&#34;True&#34;</span>
    <span style=color:#66d9ef>type</span>: Ready
  <span style=color:#66d9ef>deprovisionStatus</span>: Required
  <span style=color:#66d9ef>externalProperties</span>:
    <span style=color:#66d9ef>clusterServicePlanExternalID</span>: 13373a9b-d5f5-4d9a-88df-d696bbc19071
    <span style=color:#66d9ef>clusterServicePlanExternalName</span>: postgresql
    <span style=color:#66d9ef>parameterChecksum</span>: cdc7984a164fef77f2027f285e7b2bdc931a861461726f5aec961c812a3745e0
    <span style=color:#66d9ef>parameters</span>:
      <span style=color:#66d9ef>metadata</span>:
        <span style=color:#66d9ef>labels</span>:
          <span style=color:#66d9ef>app</span>: my-postgres
      <span style=color:#66d9ef>spec</span>:
        <span style=color:#66d9ef>storage</span>:
          <span style=color:#66d9ef>accessModes</span>:
          - ReadWriteOnce
          <span style=color:#66d9ef>resources</span>:
            <span style=color:#66d9ef>requests</span>:
              <span style=color:#66d9ef>storage</span>: 1Gi
          <span style=color:#66d9ef>storageClassName</span>: standard
        <span style=color:#66d9ef>terminationPolicy</span>: WipeOut
        <span style=color:#66d9ef>version</span>: <span style=color:#ae81ff>10.2</span>-v1
    <span style=color:#66d9ef>userInfo</span>:
      <span style=color:#66d9ef>groups</span>:
      - system:masters
      - system:authenticated
      <span style=color:#66d9ef>uid</span>: <span style=color:#e6db74>&#34;&#34;</span>
      <span style=color:#66d9ef>username</span>: minikube-user
  <span style=color:#66d9ef>observedGeneration</span>: <span style=color:#ae81ff>1</span>
  <span style=color:#66d9ef>orphanMitigationInProgress</span>: <span style=color:#66d9ef>false</span>
  <span style=color:#66d9ef>provisionStatus</span>: Provisioned
  <span style=color:#66d9ef>reconciledGeneration</span>: <span style=color:#ae81ff>1</span>
</code></pre></div><h2 id=binding-creating-a-servicebinding-for-this-serviceinstance>Binding: Creating a ServiceBinding for this ServiceInstance</h2><p>We have a ready <code>ServiceInstance</code>. To use this service, we can bind to it. AppsCode Service Broker currently supports no parameter for binding. Now, create a <code>ServiceBinding</code> resource:</p><pre><code class=language-console data-lang=console>$ kubectl create -f docs/examples/postgresql-binding.yaml
servicebinding.servicecatalog.k8s.io/postgresqldb created
</code></pre><p>Once the <code>ServiceBinding</code> resource is created, the service catalog controller initiates binding process by communicating with the service broker server. In general, the broker server returns the necessary credentials in this step. Then the service catalog controller will insert them into a Kubernetes <code>Secret</code> object.</p><pre><code class=language-console data-lang=console>$ kubectl get servicebindings postgresqldb --namespace demo
NAME           SERVICE-INSTANCE   SECRET-NAME    STATUS   AGE
postgresqldb   postgresqldb       postgresqldb   Ready    1m

$ svcat get bindings postgresqldb --namespace demo
      NAME       NAMESPACE     INSTANCE     STATUS
+--------------+-----------+--------------+--------+
  postgresqldb   demo        postgresqldb   Ready

$ svcat describe bindings postgresqldb --namespace demo
  Name:        postgresqldb
  Namespace:   demo
  Status:      Ready - Injected bind result @ 2018-12-26 10:21:12 +0000 UTC
  Secret:      postgresqldb
  Instance:    postgresqldb

Parameters:
  No parameters defined

Secret Data:
  Host       21 bytes
  Password   16 bytes
  Port       4 bytes
  Protocol   10 bytes
  RootCert   4 bytes
  URI        56 bytes
  Username   8 bytes
</code></pre><p>You can see the secret data by passing <code>--show-secrets</code> flag to the above command. The yaml configuration of this <code>ServiceBinding</code> resource is as follows:</p><pre><code class=language-console data-lang=console>kubectl get servicebindings postgresqldb --namespace demo -o yaml
</code></pre><p>Output:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>apiVersion</span>: servicecatalog.k8s.io/v1beta1
<span style=color:#66d9ef>kind</span>: ServiceBinding
<span style=color:#66d9ef>metadata</span>:
  <span style=color:#66d9ef>creationTimestamp</span>: <span style=color:#e6db74>&#34;2018-12-26T10:21:11Z&#34;</span>
  <span style=color:#66d9ef>finalizers</span>:
  - kubernetes-incubator/service-catalog
  <span style=color:#66d9ef>generation</span>: <span style=color:#ae81ff>1</span>
  <span style=color:#66d9ef>labels</span>:
    <span style=color:#66d9ef>app</span>: appscode-service-broker
  <span style=color:#66d9ef>name</span>: postgresqldb
  <span style=color:#66d9ef>namespace</span>: demo
  <span style=color:#66d9ef>resourceVersion</span>: <span style=color:#e6db74>&#34;206&#34;</span>
  <span style=color:#66d9ef>selfLink</span>: /apis/servicecatalog.k8s.io/v1beta1/namespaces/demo/servicebindings/postgresqldb
  <span style=color:#66d9ef>uid</span>: f7be4740-08f7<span style=color:#ae81ff>-11e9</span>-9fa4-0242ac110006
<span style=color:#66d9ef>spec</span>:
  <span style=color:#66d9ef>externalID</span>: f7be46f6-08f7<span style=color:#ae81ff>-11e9</span>-9fa4-0242ac110006
  <span style=color:#66d9ef>instanceRef</span>:
    <span style=color:#66d9ef>name</span>: postgresqldb
  <span style=color:#66d9ef>secretName</span>: postgresqldb
  <span style=color:#66d9ef>userInfo</span>:
    <span style=color:#66d9ef>groups</span>:
    - system:masters
    - system:authenticated
    <span style=color:#66d9ef>uid</span>: <span style=color:#e6db74>&#34;&#34;</span>
    <span style=color:#66d9ef>username</span>: minikube-user
<span style=color:#66d9ef>status</span>:
  <span style=color:#66d9ef>asyncOpInProgress</span>: <span style=color:#66d9ef>false</span>
  <span style=color:#66d9ef>conditions</span>:
  - <span style=color:#66d9ef>lastTransitionTime</span>: <span style=color:#e6db74>&#34;2018-12-26T10:21:12Z&#34;</span>
    <span style=color:#66d9ef>message</span>: Injected bind result
    <span style=color:#66d9ef>reason</span>: InjectedBindResult
    <span style=color:#66d9ef>status</span>: <span style=color:#e6db74>&#34;True&#34;</span>
    <span style=color:#66d9ef>type</span>: Ready
  <span style=color:#66d9ef>externalProperties</span>:
    <span style=color:#66d9ef>userInfo</span>:
      <span style=color:#66d9ef>groups</span>:
      - system:masters
      - system:authenticated
      <span style=color:#66d9ef>uid</span>: <span style=color:#e6db74>&#34;&#34;</span>
      <span style=color:#66d9ef>username</span>: minikube-user
  <span style=color:#66d9ef>orphanMitigationInProgress</span>: <span style=color:#66d9ef>false</span>
  <span style=color:#66d9ef>reconciledGeneration</span>: <span style=color:#ae81ff>1</span>
  <span style=color:#66d9ef>unbindStatus</span>: Required
</code></pre></div><p>Here, the status has <code>Ready</code> condition which means the binding is now ready for use. This binding operation creates a <code>Secret</code> named <code>postgresqldb</code> in namespace <code>demo</code>.</p><pre><code class=language-console data-lang=console>$ kubectl get secrets --namespace demo
NAME                       TYPE                                  DATA   AGE
default-token-2zx6l        kubernetes.io/service-account-token   3      4h53m
postgresqldb               Opaque                                7      3m28s
postgresqldb-auth          Opaque                                2      6m45s
postgresqldb-token-vll77   kubernetes.io/service-account-token   3      6m45s
</code></pre><h2 id=unbinding-deleting-the-servicebinding>Unbinding: Deleting the ServiceBinding</h2><p>We can now delete the <code>ServiceBinding</code> resource we created in the <code>Binding</code> step (it is called <code>Unbinding</code> the <code>ServiceInstance</code>)</p><pre><code class=language-console data-lang=console>$ kubectl delete servicebinding postgresqldb --namespace demo
servicebinding.servicecatalog.k8s.io &quot;postgresqldb&quot; deleted

$ svcat unbind postgresqldb --namespace demo
deleted postgresqldb
</code></pre><p>After completion of unbinding, the <code>Secret</code> named <code>postgresqldb</code> should be deleted.</p><pre><code class=language-console data-lang=console>$ kubectl get secrets --namespace demo
NAME                       TYPE                                  DATA   AGE
default-token-2zx6l        kubernetes.io/service-account-token   3      4h55m
postgresqldb-auth          Opaque                                2      8m49s
postgresqldb-token-vll77   kubernetes.io/service-account-token   3      8m49s
</code></pre><h2 id=deprovisioning-deleting-the-serviceinstance>Deprovisioning: Deleting the ServiceInstance</h2><p>After unbinding the <code>ServiceInstance</code>, our next step is deleting the <code>ServiceInstance</code> resource we provisioned before. It is called <code>Deprovisioning</code>.</p><pre><code class=language-console data-lang=console>$ kubectl delete serviceinstance postgresqldb --namespace demo
serviceinstance.servicecatalog.k8s.io &quot;postgresqldb&quot; deleted

$ svcat deprovision postgresqldb --namespace demo
deleted postgresqldb
</code></pre><h2 id=cleanup>Cleanup</h2><p>To cleanup the cluster, just <a href=/products/service-broker/0.1.0/setup/uninstall>uninstall</a> the broker. It&rsquo;ll delete the <code>ClusterServiceBroker</code> resource. Then service catalog controller automatically deletes all <code>ClusterServiceClass</code> and <code>ClusterServicePlan</code> resources that came from that broker.</p><pre><code class=language-console data-lang=console>$ kubectl get clusterserviceclasses
No resources found.

$ svcat get classes
  NAME   NAMESPACE   DESCRIPTION
+------+-----------+-------------+
</code></pre></div></div><div class="column is-2"><div class=right-sidebar-area><div class=search-area><form action=#><input id=acSearch type=text placeholder=Search...>
<button class=search-button>
<i class="fa fa-search" aria-hidden=true></i></button></form></div><div class=tbl-of-contents><h4>What's on this Page</h4><nav id=TableOfContents><ul><li><a href=#check-clusterserviceclass-and-clusterserviceplan-for-postgres>Check ClusterServiceClass and ClusterServicePlan for Postgres</a></li><li><a href=#provisioning-creating-a-new-serviceinstance>Provisioning: Creating a New ServiceInstance</a></li><li><a href=#binding-creating-a-servicebinding-for-this-serviceinstance>Binding: Creating a ServiceBinding for this ServiceInstance</a></li><li><a href=#unbinding-deleting-the-servicebinding>Unbinding: Deleting the ServiceBinding</a></li><li><a href=#deprovisioning-deleting-the-serviceinstance>Deprovisioning: Deleting the ServiceInstance</a></li><li><a href=#cleanup>Cleanup</a></li></ul></nav></div></div></div></div></div><script>var kdDropdown=document.querySelector(".dropdown");var kdDropdownBtn=document.querySelector(".dropdown-trigger");kdDropdownBtn.addEventListener("click",function(){kdDropdown.classList.toggle("is-active");})</script></div><div class=improve-section-area><div class="container section"><div class=improve-bg-color><div class=columns><div class="column is-6"><a href=https://github.com/appscode/service-broker/edit/master/docs/guides/kubedb/postgres.md/>Improve This Page</a></div></div></div></div></div><div class=overlay-bg></div><div class=sidebar-search-area><div class=search-area-top><h3>Search</h3><div class=searchbar-area><input type=search name=search id=searchbox placeholder=Search...>
<button onclick=queryPage(1)><i class="fa fa-search" aria-hidden=true></i></button></div><span id=searchbar-script-container style=display:none></span><div class="search-meta-information level"><div class=level-left></div></div></div><div class=search-result-wrapper></div><div class=pagination-area><div class=pagination-list></div></div></div><script type=text/javascript>var pageSize=5;var acSearch=document.querySelector("#acSearch");var bodyOverlay=document.querySelector(".overlay-bg");var sidebarSearch=document.querySelector(".sidebar-search-area");acSearch.addEventListener("click",function(){bodyOverlay.style.display="block";sidebarSearch.style.right="0";document.getElementById("searchbox").focus();bodyOverlay.addEventListener("click",function(){bodyOverlay.style.display="none";sidebarSearch.style.right="-80%";});});function encodeQueryData(data){var ret=[];for(var d in data)
ret.push(encodeURIComponent(d)+'='+encodeURIComponent(data[d]));return ret.join('&');}
document.querySelector(".searchbar-area input[type=search]").addEventListener("keyup",function(event){event.preventDefault();if(event.keyCode===13){queryPage(1);}});function queryPage(idx){var q=document.getElementById("searchbox").value;var cx="015199383701854252104:jccvu4eiulw";var key="AIzaSyBo15AW3hatf4fO8actJUZ_d5qZJpx0rXM";var imgSize="small";var callback="renderResult";var src="https://www.googleapis.com/customsearch/v1?"+encodeQueryData({q:q,cx:cx,key:key,imgSize:imgSize,callback:callback,start:(idx-1)*pageSize+1,num:pageSize,});var newScript=document.createElement("script");newScript.src=src;e=document.getElementById("searchbar-script-container");var child=e.lastElementChild;if(child){e.removeChild(child);}
e.appendChild(newScript);}
function renderSearchResultEntry(e){var out='<div class="single-search-result">'+
'<h3><a href="'+e.link+'">'+e.title+'</a></h3>'+
'<a href="'+e.link+'">'+e.htmlFormattedUrl+'</a>'+
'<div class="result-description-wrapper">';if(e.pagemap&&e.pagemap.cse_thumbnail){out+='<div class="result-thumb">'+
'<img src="'+e.pagemap.cse_thumbnail[0].src+'" alt="" />'+
'</div>';}
out+='<div class="result-description">'+
'<p>'+
e.snippet+
'</p>'+
'</div>'+
'</div>'+
'</div>';return out;}
function renderResult(response){document.querySelector(".search-meta-information .level-left").innerHTML='<div class="level-left">'+
'<p>'+
'About <span class="search-count">'+response.searchInformation.formattedTotalResults+'</span> results (<span class="time-count">'+response.searchInformation.formattedSearchTime+' </span>seconds)'+
'</p>'+
'</div>';if(!response.items){return;}
var searchResultWrapper=document.querySelector(".search-result-wrapper");searchResultWrapper.innerHTML="";for(var i=0;i<response.items.length;i++){searchResultWrapper.innerHTML+=renderSearchResultEntry(response.items[i]);}
var pager='<ul>';if(response.queries.previousPage){var pageIndex=Math.floor(response.queries.previousPage[0].startIndex/pageSize)+1;pager+='<li><a href="#" onclick="queryPage('+pageIndex+')">Previous</a></li>';}
if(response.queries.request){var pageIndex=Math.floor(response.queries.request[0].startIndex/pageSize)+1;pager+='<li><a href="#" onclick="queryPage('+pageIndex+')" class="is-active">'+pageIndex+'</a></li>';}
if(response.queries.nextPage){var pageIndex=Math.floor(response.queries.nextPage[0].startIndex/pageSize)+1;pager+='<li><a href="#" onclick="queryPage('+pageIndex+')">Next</a></li>';}
pager+='</ul>';document.querySelector(".pagination-area .pagination-list").innerHTML=pager;}</script><section></section><section></section><section></section><button class=go-to-top id=goTop>
<i class="fa fa-angle-up" aria-hidden=true></i></button><footer class=footer-area><div class=footer-top><div class="container section"><div class="columns is-mobile is-multiline"><div class="column is-full-mobile is-one-third-desktop is-one-third-widescreen is-one-third-tablet" data-aos=fade-up><div class=single-footer-widget><div class=footer-logo><a href=https://appscode.com><img src=/assets/images/products/appscode/appscode.png alt=AppsCode class=img></a></div><div class=subscription-form><form action="https://appscode.us17.list-manage.com/subscribe/post?u=feb2bf31969a951e7449048a3&id=82fb19acb9" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=navbar-form target=_blank novalidate role=email role=email><label for=email>Subscribe to Our Newsletter</label><p class=spam-message>No spam, we promise. Your mail address is secure</p><div class="field has-addons"><div class=control><input class=input name=EMAIL id=mce-EMAIL type=email placeholder="Your work email address" required>
<button id=mc-embedded-subscribe type=submit name=subscribe class=button>
<i class="fa fa-paper-plane-o" aria-hidden=true></i></button></div></div></form></div><div class=contact-information><h4>Have any Inquiry?</h4><ul class=all-contact-info><li><a href=callto:+1%28650%29241-8486><span><i class="fa fa-phone" aria-hidden=true></i></span>+1(650)241-8486</a></li><li><a href=mailto:support@appscode.com><span><i class="fa fa-envelope-o" aria-hidden=true></i></span>support@appscode.com</a></li></ul></div></div></div><div class="column is-half-mobile" data-aos=fade-up data-aos-duration=800><div class=single-footer-widget><div class=footer-menu><h4>Products</h4><ul class=footer-link><li><a href=https://kubedb.com>KubeDB</a></li><li><a href=https://stash.run>Stash</a></li><li><a href=https://kubevault.com>KubeVault</a></li><li><a href=https://appscode.com/products/voyager/>Voyager</a></li><li><a href=https://appscode.com/products/guard/>Guard</a></li><li><a href=https://pharmer.io>Pharmer</a></li></ul></div></div></div><div class="column is-half-mobile" data-aos=fade-up data-aos-duration=1000><div class=single-footer-widget><div class=footer-menu><h4>Services</h4><ul class=footer-link><li><a href=https://appscode.com/pricing/>Commercial Support</a></li><li><a href=https://appscode.com/consulting/>Consulting</a></li><li><a href=https://appscode.com/training/>Training</a></li><li><a href=https://appscode.com/support/>Support</a></li></ul></div></div></div><div class="column is-half-mobile" data-aos=fade-up data-aos-duration=1200><div class=single-footer-widget><div class=footer-menu><h4>Company</h4><ul class=footer-link><li><a href=https://appscode.com/about/>About Us</a></li><li><a href=https://blog.byte.builders>Blog</a></li><li><a href=https://appscode.com/contact/>Contact Us</a></li></ul></div></div></div><div class="column is-half-mobile" data-aos=fade-up data-aos-duration=1500><div class=single-footer-widget><div class=footer-menu><h4>Legal</h4><ul class=footer-link><li><a href=https://appscode.com/legal/tos/>Terms of Sevice</a></li><li><a href=https://appscode.com/legal/privacy-policy/>Privacy Policy</a></li><li><a href=https://appscode.com/legal/security/>Security</a></li><li><a href=https://appscode.com/legal/sla/>Service Level Agreement</a></li></ul></div></div></div></div></div></div><div class=footer-bottom><div class="container section"><div class=columns><div class="column is-4"><p>© 2020 AppsCode Inc. All rights reserved.</p></div><div class="column is-4 is-mobile has-text-centered"><div class=footer-inline-link><a href=https://appscode.com/legal/privacy-policy/>Privacy Policy</a>
<a href=https://appscode.com/legal/tos/>Terms of Service</a></div></div><div class="column is-4 is-mobile has-text-right"><div class=socail-link-inline><ul><li><a href=https://twitter.com/AppsCodeHQ target=_blank rel=noopener><i class="fa fa-twitter" aria-hidden=true></i></a></li><li><a href=https://www.facebook.com/appscode target=_blank rel=noopener><i class="fa fa-facebook" aria-hidden=true></i></a></li><li><a href=https://www.youtube.com/c/AppsCodeInc target=_blank rel=noopener><i class="fa fa-youtube" aria-hidden=true></i></a></li></ul></div></div></div></div></div></footer><script src=/assets/js/bulma-carousel.min.js></script><script src=https://unpkg.com/aos@2.3.1/dist/aos.js></script><script src=https://unpkg.com/downloadjs@1.4.7/download.min.js></script><script src=https://unpkg.com/clipboard@2/dist/clipboard.min.js></script><script src=/assets/js/main.js></script><script type=text/javascript>var Tawk_API=Tawk_API||{},Tawk_LoadStart=new Date();(function(){var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];s1.async=true;s1.src='https://embed.tawk.to/5821e34b18d9f16af02864b7/default';s1.charset='UTF-8';s1.setAttribute('crossorigin','*');s0.parentNode.insertBefore(s1,s0);})();</script></body></html>